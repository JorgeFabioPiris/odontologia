unit SimplePed.View.Main;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, System.ImageList, Vcl.ImgList,
  Vcl.StdCtrls, Vcl.Buttons, Vcl.ExtCtrls,
  SimplePed.View.Home, SimplePed.View.Direccion, Vcl.Imaging.pngimage;

type
  TPageMain = class(TForm)
    ImageList1: TImageList;
    pnlMain: TPanel;
    PnlMenuLateral: TPanel;
    BtnMenLatSalir: TSpeedButton;
    PnlMenuLateralConfiguracion: TPanel;
    BtnPnelMenuConfImpresora: TSpeedButton;
    BtnPnelMenuConfBKP: TSpeedButton;
    BtnPnelMenuConfOpciones: TSpeedButton;
    PnlMenuConfiguracionDiv01: TPanel;
    PnelSombraMenuConf: TPanel;
    BtnPnelMenuConfExpandir: TSpeedButton;
    PnlMenuLateralConsulta: TPanel;
    BtnPnelMenuConsPaciente: TSpeedButton;
    BtnPnelMenuConsConsSeguro: TSpeedButton;
    BtnPnelMenuConsAgenda: TSpeedButton;
    BtnPnelMenuConsEmpresa: TSpeedButton;
    BtnPnelMenuConsMedico: TSpeedButton;
    BtnPnelMenuConsProveedor: TSpeedButton;
    PnlMenuConsultaDiv01: TPanel;
    PnelSombraMenuCons: TPanel;
    BtnPnelMenuConsExpandir: TSpeedButton;
    PnlMenuLateralDiv01: TPanel;
    PnlMenuLateralDiv02: TPanel;
    PnlMenuLateralDiv03: TPanel;
    PnlMenuLateralDiv04: TPanel;
    PnlMenuLateralDiv05: TPanel;
    PnlMenuLateralFinanciero: TPanel;
    BtnPnelMenuFinanLanzamiento: TSpeedButton;
    BtnPnelMenuFinanListadoCaja: TSpeedButton;
    BtnPnelMenuFinanSaldoCaja: TSpeedButton;
    BtnPnelMenuFinanHistorial: TSpeedButton;
    PnlMenuFinancieroDiv01: TPanel;
    PnelSombraMenuFinan: TPanel;
    BtnPnelMenuFinanExpandir: TSpeedButton;
    PnlMenuLateralRegistro: TPanel;
    BtnPnelMenuRegPaciente: TSpeedButton;
    BtnPnelMenuRegSeguro: TSpeedButton;
    BtnPnelMenuRegFuncionario: TSpeedButton;
    BtnPnelMenuRegDireccion: TSpeedButton;
    BtnPnelMenuRegProducto: TSpeedButton;
    BtnPnelMenuRegUsuario: TSpeedButton;
    BtnPnelMenuRegAgenda: TSpeedButton;
    BtnPnelMenuRegEmpresa: TSpeedButton;
    BtnPnelMenuRegMedico: TSpeedButton;
    BtnPnelMenuRegProveedor: TSpeedButton;
    PnlMenuRegistroDiv01: TPanel;
    PnelSombraMenuReg: TPanel;
    BtnPnelMenuRegExpandir: TSpeedButton;
    pnlCentral: TPanel;
    pnlCabecera: TPanel;
    PnlBotonera: TPanel;
    PnlSombraBotoneraCaja: TPanel;
    BtnPnlBotoneraCaja: TSpeedButton;
    PnlSombraBotoneraServicio: TPanel;
    BtnPnlBotoneraServicio: TSpeedButton;
    PnlSombraBotoneraAgenda: TPanel;
    BtnPnlBotoneraAgenda: TSpeedButton;
    PnlSombraBotoneraMedico: TPanel;
    BtnPnlBotoneraMedico: TSpeedButton;
    PnlSombraBotoneraPaciente: TPanel;
    BtnPnlBotoneraPaciente: TSpeedButton;
    PnlSombraBotoneraSaldo: TPanel;
    BtnPnlBotoneraCajaSaldo: TSpeedButton;
    PnlSombraBotoneraInicio: TPanel;
    BtnMenLatInicio: TSpeedButton;
    PnlBotoneraResaltador: TPanel;
    PnlTitulo: TPanel;
    lblTitulo: TLabel;
    Image1: TImage;
    procedure FormCreate(Sender: TObject);
    procedure BtnPnelMenuRegDireccionClick(Sender: TObject);
    procedure BtnMenLatInicioClick(Sender: TObject);
    procedure BtnPnlBotoneraPacienteClick(Sender: TObject);
    procedure BtnPnlBotoneraMedicoClick(Sender: TObject);
    procedure BtnPnlBotoneraAgendaClick(Sender: TObject);
    procedure BtnPnlBotoneraServicioClick(Sender: TObject);
    procedure BtnPnlBotoneraCajaClick(Sender: TObject);
    procedure BtnPnlBotoneraCajaSaldoClick(Sender: TObject);
    procedure BtnPnelMenuRegExpandirClick(Sender: TObject);
    procedure BtnPnelMenuFinanExpandirClick(Sender: TObject);
    procedure BtnPnelMenuConsExpandirClick(Sender: TObject);
    procedure BtnPnelMenuConfExpandirClick(Sender: TObject);
  private
    { Private declarations }
    procedure prc_expandir_menu(largo_panel: Integer; boton: TSpeedButton);
    procedure prc_mover_resaltador(panel: TPanel);
    procedure prc_marcar_boton_activo(boton: TSpeedButton; marcar: Boolean);
  public
    { Public declarations }
  end;

var
  PageMain: TPageMain;
  PagHome: TPagHome;
  PagDireccion: TPagDireccion;
  nombre_comp: String;

implementation

{$R *.dfm}

procedure TPageMain.BtnMenLatInicioClick(Sender: TObject);
begin
  prc_marcar_boton_activo(TComponent(Sender) as TSpeedButton, true);
  prc_mover_resaltador(PnlSombraBotoneraInicio);

end;

procedure TPageMain.BtnPnelMenuConfExpandirClick(Sender: TObject);
var
  largo: Integer;
begin
  prc_expandir_menu(180, TComponent(Sender) as TSpeedButton);
end;

procedure TPageMain.BtnPnelMenuConsExpandirClick(Sender: TObject);
var
  largo: Integer;
begin
  prc_expandir_menu(315, TComponent(Sender) as TSpeedButton);
end;

procedure TPageMain.BtnPnelMenuFinanExpandirClick(Sender: TObject);
var
  largo: Integer;
begin
  prc_expandir_menu(225, TComponent(Sender) as TSpeedButton);
end;

procedure TPageMain.BtnPnelMenuRegDireccionClick(Sender: TObject);
begin
  PagDireccion := TPagDireccion.Create(Self);
  PagDireccion.Parent := pnlCentral;
  PagDireccion.Show;
end;

procedure TPageMain.BtnPnelMenuRegExpandirClick(Sender: TObject);
var
  largo: Integer;
begin
  prc_expandir_menu(495, TComponent(Sender) as TSpeedButton);
end;

procedure TPageMain.BtnPnlBotoneraAgendaClick(Sender: TObject);
begin
  prc_marcar_boton_activo(TComponent(Sender) as TSpeedButton, true);
  prc_mover_resaltador(PnlSombraBotoneraAgenda);
end;

procedure TPageMain.BtnPnlBotoneraCajaClick(Sender: TObject);
begin
  prc_marcar_boton_activo(TComponent(Sender) as TSpeedButton, true);
  prc_mover_resaltador(PnlSombraBotoneraCaja);
end;

procedure TPageMain.BtnPnlBotoneraCajaSaldoClick(Sender: TObject);
begin
  prc_marcar_boton_activo(TComponent(Sender) as TSpeedButton, true);
  prc_mover_resaltador(PnlSombraBotoneraSaldo);
end;

procedure TPageMain.BtnPnlBotoneraMedicoClick(Sender: TObject);
begin
  prc_marcar_boton_activo(TComponent(Sender) as TSpeedButton, true);
  prc_mover_resaltador(PnlSombraBotoneraMedico);
end;

procedure TPageMain.BtnPnlBotoneraPacienteClick(Sender: TObject);
begin
  prc_marcar_boton_activo(TComponent(Sender) as TSpeedButton, true);
  prc_mover_resaltador(PnlSombraBotoneraPaciente);
end;

procedure TPageMain.BtnPnlBotoneraServicioClick(Sender: TObject);
begin
  prc_marcar_boton_activo(TComponent(Sender) as TSpeedButton, true);
  prc_mover_resaltador(PnlSombraBotoneraServicio);
end;

procedure TPageMain.FormCreate(Sender: TObject);
begin
  PagHome := TPagHome.Create(Self);
  PagHome.Parent := pnlCentral;
  PagHome.Show;
  nombre_comp := '';
  prc_expandir_menu(45, BtnPnlBotoneraPaciente);
  // prc_mover_resaltador(PnlSombraBotoneraInicio);
  prc_marcar_boton_activo(BtnMenLatInicio, false);
  BtnMenLatInicio.Click;
end;

procedure TPageMain.prc_expandir_menu(largo_panel: Integer;
  boton: TSpeedButton);
var
  i: Integer;
  expandir: Boolean;
begin

  if nombre_comp <> (boton).GetNamePath then
  begin
    expandir := true;
  end
  else
  begin
    expandir := false;
  end;

  if expandir then
  begin
    // Recorrer los componentes del formulario
    for i := 0 to PageMain.ComponentCount - 1 do
    begin
      // Verifica si el componente es un panel
      if (PageMain.Components[i] is TPanel) and
        ((PageMain.Components[i] as TPanel).Tag <> 0) then
      begin
        // Verifica que el panel está asociado al boton pasado como parametro
        if (PageMain.Components[i] as TPanel).Tag = boton.Tag then
        begin
          // Muestra el panel asociado al boton
          (PageMain.Components[i] as TPanel).Height := largo_panel;
        end
        else
          (PageMain.Components[i] as TPanel).Height := 45;
      end;

    end;
    nombre_comp := boton.GetNamePath
  end
  else // fin de expandir
  // Recorrer los componentes del formulario
  begin
    for i := 0 to PageMain.ComponentCount - 1 do
    begin
      // Verifica si el componente es un panel
      if (PageMain.Components[i] is TPanel) and
        ((PageMain.Components[i] as TPanel).Tag <> 0) then
      begin
        (PageMain.Components[i] as TPanel).Height := 45;
      end;
    end;
    nombre_comp := ''
  end;
end;

procedure TPageMain.prc_marcar_boton_activo(boton: TSpeedButton;
  marcar: Boolean);
var
  i: Integer;
begin
  PnlBotoneraResaltador.Visible := false;
  if marcar then // En caso de que el parametro sea verdadero
  begin
    // Recorrer los componentes del formulario
    for i := 0 to PageMain.ComponentCount - 1 do
    begin
      // Verifica si el componente es un Panel y si su Tag esta en el rango deseado
      if (PageMain.Components[i] is TPanel) and
        ((PageMain.Components[i] as TPanel).Tag > 100) then
      begin
        // Verifica que el panel está asociado al boton pasado como parametro
        if (PageMain.Components[i] as TPanel).Tag = (boton.Tag + 100) then
        begin
          // Muestra el panel asociado al boton
          (PageMain.Components[i] as TPanel).Color := clGray;
        end
        else
          (PageMain.Components[i] as TPanel).Color := clWhite;
      end;

    end;

  end
  else // En caso del parametro ser falso
  // Recorrer los componentes del formulario
  begin
    for i := 0 to PageMain.ComponentCount - 1 do
    begin
      // Verifica si el componente es un Panel y si su Tag esta en el rango deseado
      if (PageMain.Components[i] is TPanel) and
        ((PageMain.Components[i] as TPanel).Tag > 100) then
      begin
        (PageMain.Components[i] as TPanel).Color := clWhite;
      end;
    end;
  end;
end;

procedure TPageMain.prc_mover_resaltador(panel: TPanel);
begin
  PnlBotoneraResaltador.Visible := true;
  nombre_comp := '';
  prc_expandir_menu(45, BtnPnlBotoneraPaciente);
  PnlBotoneraResaltador.Left := panel.Left;
  PnlBotoneraResaltador.Width := panel.Width;
end;

end.
